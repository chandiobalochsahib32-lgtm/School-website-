<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Innovative Public School Ameer Bux Khaskheli</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f9fc;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzI2YTY5OSIgc3RvcC1vcGFjaXR5PSIwLjEiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMxYTVmN2EiIHN0b3Atb3BhY2l0eT0iMC4xIi8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNnKSIvPjwvc3ZnPg==');
            background-size: cover;
            background-attachment: fixed;
        }

        /* Background Theme Options */
        .theme-light {
            background-color: #f5f9fc;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzI2YTY5OSIgc3RvcC1vcGFjaXR5PSIwLjEiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMxYTVmN2EiIHN0b3Atb3BhY2l0eT0iMC4xIi8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNnKSIvPjwvc3ZnPg==');
        }

        .theme-blue {
            background-color: #e8f4fc;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzFlODliZCIgc3RvcC1vcGFjaXR5PSIwLjA1Ii8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjMWFhNWQxIiBzdG9wLW9wYWNpdHk9IjAuMDUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2cpIi8+PC9zdmc+');
        }

        .theme-green {
            background-color: #f0f9f0;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzIwYzk1MyIgc3RvcC1vcGFjaXR5PSIwLjA1Ii8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjMTZhNTRhIiBzdG9wLW9wYWNpdHk9IjAuMDUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2cpIi8+PC9zdmc+');
        }

        .theme-warm {
            background-color: #fef7f0;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2Y1OTgwMCIgc3RvcC1vcGFjaXR5PSIwLjA1Ii8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjZDU3YzAwIiBzdG9wLW9wYWNpdHk9IjAuMDUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2cpIi8+PC9zdmc+');
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(135deg, #1a5f7a 0%, #159895 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo i {
            font-size: 2.5rem;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .logo span {
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .head-master {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background 0.3s;
        }

        nav a:hover, nav a.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .theme-selector {
            display: flex;
            gap: 8px;
            margin-left: 20px;
        }

        .theme-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .theme-btn:hover {
            transform: scale(1.1);
        }

        .theme-btn.active {
            transform: scale(1.1);
            border-width: 3px;
        }

        .theme-light-btn { background: #f5f9fc; }
        .theme-blue-btn { background: #e8f4fc; }
        .theme-green-btn { background: #f0f9f0; }
        .theme-warm-btn { background: #fef7f0; }

        .main-content {
            display: flex;
            margin-top: 30px;
            gap: 30px;
        }

        .sidebar {
            flex: 0 0 250px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            height: fit-content;
            backdrop-filter: blur(5px);
        }

        .sidebar h3 {
            color: #1a5f7a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .sidebar ul {
            list-style: none;
        }

        .sidebar li {
            margin-bottom: 15px;
        }

        .sidebar a {
            color: #555;
            text-decoration: none;
            display: block;
            padding: 12px 15px;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }

        .sidebar a:hover, .sidebar a.active {
            background-color: #e8f4fc;
            color: #1a5f7a;
            transform: translateX(5px);
        }

        .sidebar i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .content {
            flex: 1;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
            backdrop-filter: blur(5px);
        }

        .content h2 {
            color: #1a5f7a;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }

        .required::after {
            content: " *";
            color: #dc3545;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #1a5f7a;
            outline: none;
        }

        .btn {
            background: linear-gradient(to right, #1a5f7a, #159895);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(26, 95, 122, 0.2);
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-secondary {
            background: linear-gradient(to right, #6c658d, #495057);
        }

        .btn-secondary:hover {
            box-shadow: 0 7px 14px rgba(108, 117, 125, 0.2);
        }

        .btn-danger {
            background: linear-gradient(to right, #dc3545, #c82333);
        }

        .btn-danger:hover {
            box-shadow: 0 7px 14px rgba(220, 53, 69, 0.2);
        }

        .btn-success {
            background: linear-gradient(to right, #28a745, #218838);
        }

        .btn-success:hover {
            box-shadow: 0 7px 14px rgba(40, 167, 69, 0.2);
        }

        .btn-warning {
            background: linear-gradient(to right, #ffc107, #e0a800);
            color: #212529;
        }

        .btn-warning:hover {
            box-shadow: 0 7px 14px rgba(255, 193, 7, 0.2);
        }

        .table-container {
            overflow-x: auto;
            margin-top: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8fafc;
            color: #1a5f7a;
            font-weight: 700;
        }

        tr:hover {
            background-color: #f9f9f9;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .action-btn.edit {
            background-color: #e7f4ff;
            color: #0066cc;
        }

        .action-btn.delete {
            background-color: #ffeaea;
            color: #dc3545;
        }

        .action-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .attendance-calendar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 10px;
        }

        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .calendar-nav button {
            background-color: white;
            border: 1px solid #ddd;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .calendar-nav button:hover {
            background-color: #1a5f7a;
            color: white;
        }

        .attendance-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
      <!-- Teacher Attendance -->
<div id="teacher-attendance" class="content-section hidden">
    <h2>Teacher Attendance</h2>
    <p>Mark and view attendance for teachers with Present, Absent, and Leave options.</p>
    
    <div class="attendance-calendar">
        <!-- Calendar navigation code -->
    </div>
    
    <!-- ADD HEAD MASTER SECTION HERE -->
        .present-btn, .absent-btn, .leave-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .present-btn {
            background-color: #e7f7ef;
            color: #28a745;
        }

        .present-btn:hover {
            background-color: #28a745;
            color: white;
        }

        .absent-btn {
            background-color: #fdf2f2;
            color: #dc3545;
        }

        .absent-btn:hover {
            background-color: #dc3545;
            color: white;
        }

        .leave-btn {
            background-color: #fff3cd;
            color: #856404;
        }

        .leave-btn:hover {
            background-color: #ffc107;
            color: #212529;
        }

        .attendance-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-present {
            background-color: #e7f7ef;
            color: #28a745;
        }

        .status-absent {
            background-color: #fdf2f2;
            color: #dc3545;
        }

        .status-leave {
            background-color: #fff3cd;
            color: #856404;
        }

        .footer {
            text-align: center;
            padding: 25px 0;
            margin-top: 40px;
            color: #666;
            border-top: 1px solid #eee;
            background-color: rgba(255, 255, 255, 0.95);
        }

        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .card {
            background: linear-gradient(135deg, #1a5f7a 0%, #159895 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .card h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .card p {
            opacity: 0.9;
        }

        .hidden {
            display: none;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.error {
            background-color: #dc3545;
        }

        .notification.warning {
            background-color: #ffc107;
            color: #212529;
        }

        /* Photo Upload Styles */
        .photo-upload-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }

        .photo-preview {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px solid #1a5f7a;
            margin-bottom: 15px;
        }

        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-placeholder {
            font-size: 3rem;
            color: #999;
        }

        .photo-upload-btn {
            background: linear-gradient(to right, #6c757d, #495057);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .photo-upload-btn:hover {
            background: linear-gradient(to right, #5a6268, #3d4348);
        }

        /* Class-wise Attendance Stats */
        .class-stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .class-stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #1a5f7a;
        }

        .class-stat-card h4 {
            color: #1a5f7a;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .stat-present { color: #28a745; font-weight: 600; }
        .stat-absent { color: #dc3545; font-weight: 600; }
        .stat-leave { color: #ffc107; font-weight: 600; }

        /* Profile Photo in Tables */
        .profile-photo-small {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ddd;
        }

        .photo-cell {
            width: 60px;
        }

        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                flex: none;
                width: 100%;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            nav ul {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .head-master {
                margin-top: 10px;
            }
            
            .theme-selector {
                margin-left: 0;
                margin-top: 10px;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .attendance-calendar {
                flex-direction: column;
                gap: 20px;
            }
            
            .attendance-actions {
                width: 100%;
                justify-content: center;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .class-stats-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="theme-light">
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <div>
                    <h1>Innovative Public School</h1>
                    <span>Ameer Bux Khaskheli</span>
                    <div class="head-master">
                        <i class="fas fa-user-tie"></i> Head Master: <span id="head-master-name">Not Set</span>
                    </div>
                </div>
            </div>
            <div style="display: flex; align-items: center;">
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-target="dashboard">Dashboard</a></li>
                        <li><a href="#" class="nav-link" data-target="student-registration">Student Registration</a></li>
                        <li><a href="#" class="nav-link" data-target="teacher-management-section">Teacher Management</a></li>
                        <li><a href="#" class="nav-link" data-target="teacher-attendance">Teacher Attendance</a></li>
                        <li><a href="#" class="nav-link" data-target="student-attendance">Student Attendance</a></li>
                    </ul>
                </nav>
                <div class="theme-selector">
                    <div class="theme-btn theme-light-btn active" data-theme="light"></div>
                    <div class="theme-btn theme-blue-btn" data-theme="blue"></div>
                    <div class="theme-btn theme-green-btn" data-theme="green"></div>
                    <div class="theme-btn theme-warm-btn" data-theme="warm"></div>
                </div>
            </div>
        </div>
    </header>

    <div class="container main-content">
        <div class="sidebar">
            <h3>School Management</h3>
            <ul>
                <li><a href="#" class="sidebar-link active" data-target="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="#" class="sidebar-link" data-target="student-registration"><i class="fas fa-user-plus"></i> Student Registration</a></li>
                <li><a href="#" class="sidebar-link" data-target="teacher-management-section"><i class="fas fa-chalkboard-teacher"></i> Teacher Management</a></li>
                <li><a href="#" class="sidebar-link" data-target="teacher-attendance"><i class="fas fa-calendar-check"></i> Teacher Attendance</a></li>
                <li><a href="#" class="sidebar-link" data-target="student-attendance"><i class="fas fa-users"></i> Student Attendance</a></li>
                <li><a href="#" class="sidebar-link" data-target="class-stats"><i class="fas fa-chart-pie"></i> Class Statistics</a></li>
                <li><a href="#" class="sidebar-link" data-target="settings"><i class="fas fa-cog"></i> Settings</a></li>
            </ul>
            
            <h3 style="margin-top: 40px;">Quick Stats</h3>
            <div style="font-size: 0.9rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Total Students:</span>
                    <span id="total-students">0</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Total Teachers:</span>
                    <span id="total-teachers">0</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Today's Attendance:</span>
                    <span id="today-attendance">0%</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Head Master:</span>
                    <span id="sidebar-hm-name">Not Set</span>
                </div>
            </div>
            
            <div id="attendance-summary" style="margin-top: 20px;">
                <h4>Today's Summary</h4>
                <!-- Will be populated by JavaScript -->
            </div>
        </div>

        <div class="content">
            <!-- Dashboard -->
            <div id="dashboard" class="content-section">
                <h2>School Dashboard</h2>
                <p>Welcome to Innovative Public School Ameer Bux Khaskheli management system.</p>
                
                <div class="dashboard-cards">
                    <div class="card">
                        <i class="fas fa-users"></i>
                        <h3 id="dashboard-students">0</h3>
                        <p>Total Students</p>
                    </div>
                    <div class="card">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <h3 id="dashboard-teachers">0</h3>
                        <p>Total Teachers</p>
                    </div>
                    <div class="card">
                        <i class="fas fa-calendar-check"></i>
                        <h3 id="dashboard-attendance">0%</h3>
                        <p>Today's Attendance</p>
                    </div>
                    <div class="card">
                        <i class="fas fa-user-tie"></i>
                        <h3 id="dashboard-hm">-</h3>
                        <p>Head Master</p>
                    </div>
                </div>
                
                <h3 style="margin-top: 40px;">Class-wise Attendance Today</h3>
                <div class="class-stats-container" id="dashboard-class-stats">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <h3 style="margin-top: 40px;">Recent Activities</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Activity</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="recent-activities">
                            <!-- Activities will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Student Registration -->
            <div id="student-registration" class="content-section hidden">
                <h2>Student Registration</h2>
                <p>Register new students. Please fill in all required information.</p>
                
                <form id="studentForm">
                    <div class="photo-upload-container">
                        <div class="photo-preview" id="student-photo-preview">
                            <div class="photo-placeholder">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                            <img id="student-photo-img" style="display: none;">
                        </div>
                        <input type="file" id="student-photo-input" accept="image/*" style="display: none;">
                        <button type="button" class="photo-upload-btn" id="student-upload-btn">
                            <i class="fas fa-camera"></i> Upload Photo
                        </button>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="studentName" class="required">Student Name</label>
                            <input type="text" id="studentName" placeholder="Enter student full name" required>
                        </div>
                        <div class="form-group">
                            <label for="fatherName" class="required">Father's Name</label>
                            <input type="text" id="fatherName" placeholder="Enter father's name" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="dob" class="required">Date of Birth</label>
                            <input type="date" id="dob" required>
                        </div>
                        <div class="form-group">
                            <label for="studentClass" class="required">Class</label>
                            <select id="studentClass" required>
                                <option value="">Select Class</option>
                                <option value="ECCE">ECCE (Early Childhood Care and Education)</option>
                                <option value="1">Class 1</option>
                                <option value="2">Class 2</option>
                                <option value="3">Class 3</option>
                                <option value="4">Class 4</option>
                                <option value="5">Class 5</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="grNumber" class="required">GR Number</label>
                            <input type="text" id="grNumber" placeholder="Enter GR Number" required>
                        </div>
                        <div class="form-group">
                            <label for="bform" class="required">B-Form / NIC Number</label>
                            <input type="text" id="bform" placeholder="Enter B-Form or NIC number" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contact">Contact Number</label>
                            <input type="tel" id="contact" placeholder="Enter contact number">
                        </div>
                        <div class="form-group">
                            <label for="previousSchool">Previous School (if any)</label>
                            <input type="text" id="previousSchool" placeholder="Enter previous school name">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea id="address" rows="3" placeholder="Enter student's address"></textarea>
                    </div>
                    
                    <button type="submit" class="btn"><i class="fas fa-user-plus"></i> Register Student</button>
                </form>
                
                <h3 style="margin-top: 40px;">Registered Students</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="photo-cell">Photo</th>
                                <th>Name</th>
                                <th>Father's Name</th>
                                <th>GR Number</th>
                                <th>Class</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="students-list">
                            <!-- Students will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Teacher Management -->
            <div id="teacher-management-section" class="content-section hidden">
                <h2>Teacher Management</h2>
                <p>Add, edit, or remove teachers. Also set the Head Master name.</p>
                
                <div class="teacher-management">
                    <h3>Add New Teacher</h3>
                    <div class="photo-upload-container">
                        <div class="photo-preview" id="teacher-photo-preview">
                            <div class="photo-placeholder">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <img id="teacher-photo-img" style="display: none;">
                        </div>
                        <input type="file" id="teacher-photo-input" accept="image/*" style="display: none;">
                        <button type="button" class="photo-upload-btn" id="teacher-upload-btn">
                            <i class="fas fa-camera"></i> Upload Photo
                        </button>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" id="teacher-name" placeholder="Enter teacher name">
                        </div>
                        <div class="form-group">
                            <input type="text" id="teacher-designation" placeholder="Designation (e.g., Math Teacher)">
                        </div>
                        <div style="align-self: flex-end;">
                            <button class="btn btn-success" id="add-teacher-btn"><i class="fas fa-plus"></i> Add Teacher</button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <h3>Set Head Master Name</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <input type="text" id="head-master-input" placeholder="Enter Head Master name">
                            </div>
                            <div style="align-self: flex-end;">
                                <button class="btn" id="set-hm-btn"><i class="fas fa-user-tie"></i> Set Head Master</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h3>Teacher List</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="photo-cell">Photo</th>
                                <th>Name</th>
                                <th>Designation</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="teachers-list">
                            <!-- Teachers will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Teacher Attendance -->
            <div id="teacher-attendance" class="content-section hidden">
                <h2>Teacher Attendance</h2>
                <p>Mark and view attendance for teachers with Present, Absent, and Leave options.</p>
                
                <div class="attendance-calendar">
                    <div class="calendar-nav">
                        <button id="prev-day"><i class="fas fa-chevron-left"></i></button>
                        <h3 id="current-date">Today, June 15, 2023</h3>
                        <button id="next-day"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="attendance-actions">
                        <button class="present-btn" id="mark-all-present">Mark All Present</button>
                        <button class="absent-btn" id="mark-all-absent">Mark All Absent</button>
                        <button class="leave-btn" id="mark-all-leave">Mark All Leave</button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="photo-cell">Photo</th>
                                <th>Teacher Name</th>
                                <th>Designation</th>
                                <th>Attendance</th>
                                <th>Signature</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="teacher-attendance-list">
                            <!-- Teacher attendance rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <button class="btn" id="save-teacher-attendance" style="margin-top: 20px;">
                    <i class="fas fa-save"></i> Save Attendance
                </button>
            </div>

            <!-- Student Attendance -->
            <div id="student-attendance" class="content-section hidden">
                <h2>Student Attendance</h2>
                <p>Mark and view attendance for students with Present, Absent, and Leave options.</p>
                
                <div class="form-row" style="margin-bottom: 30px;">
                    <div class="form-group">
                        <label for="attendance-class">Select Class</label>
                        <select id="attendance-class">
                            <option value="ECCE">ECCE</option>
                            <option value="1">Class 1</option>
                            <option value="2">Class 2</option>
                            <option value="3">Class 3</option>
                            <option value="4">Class 4</option>
                            <option value="5">Class 5</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="attendance-month">Select Month</label>
                        <select id="attendance-month">
                            <option value="0">January</option>
                            <option value="1">February</option>
                            <option value="2">March</option>
                            <option value="3">April</option>
                            <option value="4">May</option>
                            <option value="5">June</option>
                            <option value="6">July</option>
                            <option value="7">August</option>
                            <option value="8">September</option>
                            <option value="9">October</option>
                            <option value="10">November</option>
                            <option value="11">December</option>
                        </select>
                    </div>
                </div>
                
                <div class="attendance-calendar">
                    <div class="calendar-nav">
                        <button id="prev-day-student"><i class="fas fa-chevron-left"></i></button>
                        <h3 id="current-date-student">Today, June 15, 2023</h3>
                        <button id="next-day-student"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="attendance-actions">
                        <button class="present-btn" id="mark-all-present-student">Mark All Present</button>
                        <button class="absent-btn" id="mark-all-absent-student">Mark All Absent</button>
                        <button class="leave-btn" id="mark-all-leave-student">Mark All Leave</button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="photo-cell">Photo</th>
                                <th>Student Name</th>
                                <th>Father's Name</th>
                                <th>GR Number</th>
                                <th>Class</th>
                                <th>Attendance</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="student-attendance-list">
                            <!-- Student attendance rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <button class="btn" id="save-student-attendance" style="margin-top: 20px;">
                    <i class="fas fa-save"></i> Save Attendance
                </button>
            </div>

            <!-- Class Statistics -->
            <div id="class-stats" class="content-section hidden">
                <h2>Class-wise Attendance Statistics</h2>
                <p>View detailed attendance statistics for each class.</p>
                
                <div class="form-row" style="margin-bottom: 30px;">
                    <div class="form-group">
                        <label for="stats-date">Select Date</label>
                        <input type="date" id="stats-date">
                    </div>
                    <div class="form-group">
                        <label for="stats-class">Select Class (Optional)</label>
                        <select id="stats-class">
                            <option value="">All Classes</option>
                            <option value="ECCE">ECCE</option>
                            <option value="1">Class 1</option>
                            <option value="2">Class 2</option>
                            <option value="3">Class 3</option>
                            <option value="4">Class 4</option>
                            <option value="5">Class 5</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn" id="generate-stats" style="margin-bottom: 30px;">
                    <i class="fas fa-chart-bar"></i> Generate Statistics
                </button>
                
                <div class="class-stats-container" id="detailed-class-stats">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <h3 style="margin-top: 40px;">Attendance Chart</h3>
                <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <canvas id="attendanceChart" height="100"></canvas>
                </div>
            </div>

            <!-- Settings -->
            <div id="settings" class="content-section hidden">
                <h2>System Settings</h2>
                <p>Customize your school management system.</p>
                
                <div class="form-group">
                    <h3>Background Theme</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <div class="theme-selector-large">
                                <div class="theme-option" data-theme="light">
                                    <div class="theme-preview theme-light"></div>
                                    <span>Light Theme</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="theme-option" data-theme="blue">
                                <div class="theme-preview theme-blue"></div>
                                <span>Blue Theme</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="theme-option" data-theme="green">
                                <div class="theme-preview theme-green"></div>
                                <span>Green Theme</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="theme-option" data-theme="warm">
                                <div class="theme-preview theme-warm"></div>
                                <span>Warm Theme</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <h3>Data Management</h3>
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" id="export-data">
                            <i class="fas fa-download"></i> Export All Data
                        </button>
                        <button class="btn btn-danger" id="clear-data">
                            <i class="fas fa-trash"></i> Clear All Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="container">
            <p>Innovative Public School Ameer Bux Khaskheli &copy; 2023. All rights reserved.</p>
            <p>School Management System v2.0 | Enhanced with Photos & Attendance Tracking</p>
        </div>
    </div>

    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">Operation completed successfully!</span>
    </div>

    <script>
        // Initialize data storage
        let students = JSON.parse(localStorage.getItem('students')) || [];
        let teachers = JSON.parse(localStorage.getItem('teachers')) || [
            { id: 1, name: "Ali Raza", designation: "Head Teacher", photo: null },
            { id: 2, name: "Fatima Khan", designation: "Math Teacher", photo: null },
            { id: 3, name: "Bilal Ahmed", designation: "Science Teacher", photo: null }
        ];
        let headMaster = localStorage.getItem('headMaster') || "";
        let teacherAttendance = JSON.parse(localStorage.getItem('teacherAttendance')) || {};
        let studentAttendance = JSON.parse(localStorage.getItem('studentAttendance')) || {};
        let activities = JSON.parse(localStorage.getItem('activities')) || [
            { date: "2023-06-15", activity: "Student Registration", details: "New student Ali Khan registered in Class 1" },
            { date: "2023-06-14", activity: "Attendance Marked", details: "Teacher attendance marked for 14 June 2023" },
            { date: "2023-06-13", activity: "Student Registration", details: "New student Sara Ahmed registered in ECCE" }
        ];
        let currentTheme = localStorage.getItem('theme') || 'light';
        
        // Initialize current date
        let currentDate = new Date();
        let currentDateString = formatDate(currentDate);
        
        // DOM elements
        const contentSections = document.querySelectorAll('.content-section');
        const navLinks = document.querySelectorAll('.nav-link');
        const sidebarLinks = document.querySelectorAll('.sidebar-link');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        
        // Format date to display
        function formatDate(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }
        
        // Format date for storage (YYYY-MM-DD)
        function formatDateForStorage(date) {
            return date.toISOString().split('T')[0];
        }
        
        // Apply theme
        function applyTheme(theme) {
            document.body.className = `theme-${theme}`;
            currentTheme = theme;
            localStorage.setItem('theme', theme);
            
            // Update active theme button
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.theme === theme) {
                    btn.classList.add('active');
                }
            });
        }
        
        // Show notification
        function showNotification(message, type = 'success') {
            notificationText.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Update Head Master display
        function updateHeadMasterDisplay() {
            const headMasterName = headMaster || "Not Set";
            document.getElementById('head-master-name').textContent = headMasterName;
            document.getElementById('sidebar-hm-name').textContent = headMasterName;
            document.getElementById('dashboard-hm').textContent = headMasterName;
        }
        
        // Calculate class-wise attendance
        function calculateClassStats(date) {
            const dateStr = formatDateForStorage(date);
            const classStats = {
                ECCE: { present: 0, absent: 0, leave: 0, total: 0 },
                1: { present: 0, absent: 0, leave: 0, total: 0 },
                2: { present: 0, absent: 0, leave: 0, total: 0 },
                3: { present: 0, absent: 0, leave: 0, total: 0 },
                4: { present: 0, absent: 0, leave: 0, total: 0 },
                5: { present: 0, absent: 0, leave: 0, total: 0 }
            };
            
            // Calculate student attendance
            students.forEach(student => {
                if (student.class in classStats) {
                    classStats[student.class].total++;
                    
                    if (studentAttendance[dateStr] && studentAttendance[dateStr][student.id]) {
                        const status = studentAttendance[dateStr][student.id];
                        if (status === 'present') classStats[student.class].present++;
                        else if (status === 'absent') classStats[student.class].absent++;
                        else if (status === 'leave') classStats[student.class].leave++;
                    } else {
                        classStats[student.class].absent++;
                    }
                }
            });
            
            return classStats;
        }
        
        // Update class stats in dashboard
        function updateClassStats() {
            const classStats = calculateClassStats(currentDate);
            const container = document.getElementById('dashboard-class-stats');
            container.innerHTML = '';
            
            for (const [className, stats] of Object.entries(classStats)) {
                if (stats.total > 0) {
                    const card = document.createElement('div');
                    card.className = 'class-stat-card';
                    card.innerHTML = `
                        <h4>Class ${className}</h4>
                        <div class="stat-item">
                            <span>Total Students:</span>
                            <span>${stats.total}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-present">Present:</span>
                            <span class="stat-present">${stats.present}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-absent">Absent:</span>
                            <span class="stat-absent">${stats.absent}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-leave">Leave:</span>
                            <span class="stat-leave">${stats.leave}</span>
                        </div>
                        <div class="stat-item" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee;">
                            <span>Attendance:</span>
                            <span>${stats.total > 0 ? Math.round((stats.present / stats.total) * 100) : 0}%</span>
                        </div>
                    `;
                    container.appendChild(card);
                }
            }
            
            // Update sidebar summary
            const summary = document.getElementById('attendance-summary');
            if (summary) {
                let summaryHtml = '<h4>Today\'s Summary</h4>';
                for (const [className, stats] of Object.entries(classStats)) {
                    if (stats.total > 0) {
                        summaryHtml += `
                            <div style="font-size: 0.85rem; margin-top: 8px;">
                                <strong>Class ${className}:</strong> 
                                <span class="stat-present">P:${stats.present}</span> 
                                <span class="stat-absent">A:${stats.absent}</span> 
                                <span class="stat-leave">L:${stats.leave}</span>
                            </div>
                        `;
                    }
                }
                summary.innerHTML = summaryHtml;
            }
        }
        
        // Update dashboard stats
        function updateDashboardStats() {
            document.getElementById('total-students').textContent = students.length;
            document.getElementById('total-teachers').textContent = teachers.length;
            document.getElementById('dashboard-students').textContent = students.length;
            document.getElementById('dashboard-teachers').textContent = teachers.length;
            
            // Calculate today's attendance
            const classStats = calculateClassStats(currentDate);
            let totalPresent = 0;
            let totalStudents = 0;
            
            for (const stats of Object.values(classStats)) {
                totalPresent += stats.present;
                totalStudents += stats.total;
            }
            
            const attendancePercentage = totalStudents > 0 ? Math.round((totalPresent / totalStudents) * 100) : 0;
            document.getElementById('today-attendance').textContent = `${attendancePercentage}%`;
            document.getElementById('dashboard-attendance').textContent = `${attendancePercentage}%`;
            
            // Update class stats
            updateClassStats();
            
            // Update recent activities
            const activitiesList = document.getElementById('recent-activities');
            activitiesList.innerHTML = '';
            
            const sortedActivities = [...activities].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            
            sortedActivities.forEach(activity => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${activity.date}</td>
                    <td>${activity.activity}</td>
                    <td>${activity.details}</td>
                `;
                activitiesList.appendChild(row);
            });
        }
        
        // Switch between content sections
        function showSection(sectionId) {
            contentSections.forEach(section => {
                section.classList.add('hidden');
            });
            
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.remove('hidden');
            }
            
            // Update active nav link
            navLinks.forEach(link => {
                if (link.dataset.target === sectionId) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
            
            // Update active sidebar link
            sidebarLinks.forEach(link => {
                if (link.dataset.target === sectionId) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
            
            // Load data for the section
            if (sectionId === 'student-registration') {
                loadStudentsList();
            } else if (sectionId === 'teacher-management-section') {
                loadTeachersList();
            } else if (sectionId === 'teacher-attendance') {
                loadTeacherAttendance();
            } else if (sectionId === 'student-attendance') {
                loadStudentAttendance();
            } else if (sectionId === 'class-stats') {
                loadClassStats();
            }
        }
        
        // Load students list
        function loadStudentsList() {
            const studentsList = document.getElementById('students-list');
            studentsList.innerHTML = '';
            
            if (students.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center;">No students registered yet.</td>`;
                studentsList.appendChild(row);
                return;
            }
            
            students.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="photo-cell">
                        ${student.photo ? 
                            `<img src="${student.photo}" class="profile-photo-small" alt="${student.name}">` : 
                            `<div style="width:40px;height:40px;border-radius:50%;background:#f0f0f0;display:flex;align-items:center;justify-content:center;">
                                <i class="fas fa-user-graduate" style="color:#999;"></i>
                            </div>`
                        }
                    </td>
                    <td>${student.name}</td>
                    <td>${student.fatherName}</td>
                    <td>${student.grNumber}</td>
                    <td>${student.class}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit" data-student-id="${student.id}">Edit</button>
                            <button class="action-btn delete" data-student-id="${student.id}">Remove</button>
                        </div>
                    </td>
                `;
                studentsList.appendChild(row);
            });
        }
        
        // Load teachers list
        function loadTeachersList() {
            const teachersList = document.getElementById('teachers-list');
            teachersList.innerHTML = '';
            
            if (teachers.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="5" style="text-align: center;">No teachers added yet.</td>`;
                teachersList.appendChild(row);
                return;
            }
            
            teachers.forEach(teacher => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="photo-cell">
                        ${teacher.photo ? 
                            `<img src="${teacher.photo}" class="profile-photo-small" alt="${teacher.name}">` : 
                            `<div style="width:40px;height:40px;border-radius:50%;background:#f0f0f0;display:flex;align-items:center;justify-content:center;">
                                <i class="fas fa-chalkboard-teacher" style="color:#999;"></i>
                            </div>`
                        }
                    </td>
                    <td>${teacher.name}</td>
                    <td>${teacher.designation}</td>
                    <td>${teacher.name === headMaster ? '<span class="status-present">Head Master</span>' : 'Teacher'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn delete" data-teacher-id="${teacher.id}">Remove</button>
                        </div>
                    </td>
                `;
                teachersList.appendChild(row);
            });
            
            // Set head master input value
            document.getElementById('head-master-input').value = headMaster;
        }
        
        // Load teacher attendance
        function loadTeacherAttendance() {
            const currentDateStorage = formatDateForStorage(currentDate);
            const teacherAttendanceList = document.getElementById('teacher-attendance-list');
            teacherAttendanceList.innerHTML = '';
            
            // Update displayed date
            document.getElementById('current-date').textContent = formatDate(currentDate);
            
            if (teachers.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center;">No teachers available. Please add teachers first.</td>`;
                teacherAttendanceList.appendChild(row);
                return;
            }
            
            teachers.forEach(teacher => {
                const row = document.createElement('tr');
                const attendanceStatus = teacherAttendance[currentDateStorage] && teacherAttendance[currentDateStorage][teacher.id] ? 
                    teacherAttendance[currentDateStorage][teacher.id] : 'absent';
                
                row.innerHTML = `
                    <td class="photo-cell">
                        ${teacher.photo ? 
                            `<img src="${teacher.photo}" class="profile-photo-small" alt="${teacher.name}">` : 
                            `<div style="width:40px;height:40px;border-radius:50%;background:#f0f0f0;display:flex;align-items:center;justify-content:center;">
                                <i class="fas fa-chalkboard-teacher" style="color:#999;"></i>
                            </div>`
                        }
                    </td>
                    <td>${teacher.name} ${teacher.name === headMaster ? '<span class="status-present" style="margin-left:5px;font-size:0.7rem;">HM</span>' : ''}</td>
                    <td>${teacher.designation}</td>
                    <td>
                        <span class="attendance-status ${attendanceStatus === 'present' ? 'status-present' : attendanceStatus === 'leave' ? 'status-leave' : 'status-absent'}">
                            ${attendanceStatus === 'present' ? 'Present' : attendanceStatus === 'leave' ? 'On Leave' : 'Absent'}
                        </span>
                    </td>
                    <td>
                        <input type="text" class="teacher-signature" data-teacher-id="${teacher.id}" 
                               placeholder="Enter signature" value="${teacher.signature || ''}">
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="present-btn mark-teacher-attendance" data-teacher-id="${teacher.id}" data-status="present">Present</button>
                            <button class="absent-btn mark-teacher-attendance" data-teacher-id="${teacher.id}" data-status="absent">Absent</button>
                            <button class="leave-btn mark-teacher-attendance" data-teacher-id="${teacher.id}" data-status="leave">Leave</button>
                        </div>
                    </td>
                `;
                teacherAttendanceList.appendChild(row);
            });
            
            // Add event listeners for attendance buttons
            document.querySelectorAll('.mark-teacher-attendance').forEach(button => {
                button.addEventListener('click', function() {
                    const teacherId = parseInt(this.dataset.teacherId);
                    const status = this.dataset.status;
                    markTeacherAttendance(teacherId, status);
                });
            });
            
            // Add event listeners for signature inputs
            document.querySelectorAll('.teacher-signature').forEach(input => {
                input.addEventListener('change', function() {
                    const teacherId = parseInt(this.dataset.teacherId);
                    const signature = this.value;
                    updateTeacherSignature(teacherId, signature);
                });
            });
        }
        
        // Mark teacher attendance
        function markTeacherAttendance(teacherId, status) {
            const currentDateStorage = formatDateForStorage(currentDate);
            
            if (!teacherAttendance[currentDateStorage]) {
                teacherAttendance[currentDateStorage] = {};
            }
            
            teacherAttendance[currentDateStorage][teacherId] = status;
            
            // Update UI
            const statusElement = document.querySelector(`[data-teacher-id="${teacherId}"]`).closest('tr').querySelector('.attendance-status');
            if (statusElement) {
                statusElement.textContent = status === 'present' ? 'Present' : status === 'leave' ? 'On Leave' : 'Absent';
                statusElement.className = `attendance-status ${status === 'present' ? 'status-present' : status === 'leave' ? 'status-leave' : 'status-absent'}`;
            }
            
            showNotification(`Attendance marked as ${status} for teacher`, 'success');
            updateDashboardStats();
        }
        
        // Load student attendance
        function loadStudentAttendance() {
            const selectedClass = document.getElementById('attendance-class').value;
            const currentDateStorage = formatDateForStorage(currentDate);
            const studentAttendanceList = document.getElementById('student-attendance-list');
            studentAttendanceList.innerHTML = '';
            
            // Update displayed date
            document.getElementById('current-date-student').textContent = formatDate(currentDate);
            
            // Filter students by class
            const classStudents = students.filter(student => student.class === selectedClass);
            
            if (classStudents.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="7" style="text-align: center;">No students found for ${selectedClass}. Please register students first.</td>`;
                studentAttendanceList.appendChild(row);
                return;
            }
            
            classStudents.forEach(student => {
                const attendanceStatus = studentAttendance[currentDateStorage] && studentAttendance[currentDateStorage][student.id] ? 
                    studentAttendance[currentDateStorage][student.id] : 'absent';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="photo-cell">
                        ${student.photo ? 
                            `<img src="${student.photo}" class="profile-photo-small" alt="${student.name}">` : 
                            `<div style="width:40px;height:40px;border-radius:50%;background:#f0f0f0;display:flex;align-items:center;justify-content:center;">
                                <i class="fas fa-user-graduate" style="color:#999;"></i>
                            </div>`
                        }
                    </td>
                    <td>${student.name}</td>
                    <td>${student.fatherName}</td>
                    <td>${student.grNumber}</td>
                    <td>${student.class}</td>
                    <td>
                        <span class="attendance-status ${attendanceStatus === 'present' ? 'status-present' : attendanceStatus === 'leave' ? 'status-leave' : 'status-absent'}">
                            ${attendanceStatus === 'present' ? 'Present' : attendanceStatus === 'leave' ? 'On Leave' : 'Absent'}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="present-btn mark-student-attendance" data-student-id="${student.id}" data-status="present">Present</button>
                            <button class="absent-btn mark-student-attendance" data-student-id="${student.id}" data-status="absent">Absent</button>
                            <button class="leave-btn mark-student-attendance" data-student-id="${student.id}" data-status="leave">Leave</button>
                        </div>
                    </td>
                `;
                studentAttendanceList.appendChild(row);
            });
            
            // Add event listeners for attendance buttons
            document.querySelectorAll('.mark-student-attendance').forEach(button => {
                button.addEventListener('click', function() {
                    const studentId = parseInt(this.dataset.studentId);
                    const status = this.dataset.status;
                    markStudentAttendance(studentId, status);
                });
            });
        }
        
        // Mark student attendance
        function markStudentAttendance(studentId, status) {
            const currentDateStorage = formatDateForStorage(currentDate);
            
            if (!studentAttendance[currentDateStorage]) {
                studentAttendance[currentDateStorage] = {};
            }
            
            studentAttendance[currentDateStorage][studentId] = status;
            
            // Update UI
            const statusElement = document.querySelector(`[data-student-id="${studentId}"]`).closest('tr').querySelector('.attendance-status');
            if (statusElement) {
                statusElement.textContent = status === 'present' ? 'Present' : status === 'leave' ? 'On Leave' : 'Absent';
                statusElement.className = `attendance-status ${status === 'present' ? 'status-present' : status === 'leave' ? 'status-leave' : 'status-absent'}`;
            }
            
            showNotification(`Attendance marked as ${status} for student`, 'success');
            updateDashboardStats();
        }
        
        // Load class statistics
        function loadClassStats() {
            // Set default date to today
            document.getElementById('stats-date').valueAsDate = currentDate;
        }
        
        // Generate detailed class statistics
        function generateDetailedStats() {
            const date = document.getElementById('stats-date').value ? new Date(document.getElementById('stats-date').value) : currentDate;
            const selectedClass = document.getElementById('stats-class').value;
            
            const classStats = calculateClassStats(date);
            const container = document.getElementById('detailed-class-stats');
            container.innerHTML = '';
            
            for (const [className, stats] of Object.entries(classStats)) {
                if (stats.total > 0 && (!selectedClass || className === selectedClass)) {
                    const card = document.createElement('div');
                    card.className = 'class-stat-card';
                    card.innerHTML = `
                        <h4>Class ${className}</h4>
                        <div class="stat-item">
                            <span>Date:</span>
                            <span>${formatDate(date)}</span>
                        </div>
                        <div class="stat-item">
                            <span>Total Students:</span>
                            <span>${stats.total}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-present">Present:</span>
                            <span class="stat-present">${stats.present} (${stats.total > 0 ? Math.round((stats.present / stats.total) * 100) : 0}%)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-absent">Absent:</span>
                            <span class="stat-absent">${stats.absent} (${stats.total > 0 ? Math.round((stats.absent / stats.total) * 100) : 0}%)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-leave">Leave:</span>
                            <span class="stat-leave">${stats.leave} (${stats.total > 0 ? Math.round((stats.leave / stats.total) * 100) : 0}%)</span>
                        </div>
                    `;
                    container.appendChild(card);
                }
            }
            
            if (container.innerHTML === '') {
                container.innerHTML = '<p>No attendance data available for the selected date/class.</p>';
            }
        }
        
        // Save teacher attendance to localStorage
        function saveTeacherAttendance() {
            localStorage.setItem('teacherAttendance', JSON.stringify(teacherAttendance));
            
            // Add activity
            activities.unshift({
                date: formatDateForStorage(currentDate),
                activity: "Teacher Attendance",
                details: `Teacher attendance saved for ${formatDate(currentDate)}`
            });
            localStorage.setItem('activities', JSON.stringify(activities));
            
            updateDashboardStats();
            showNotification('Teacher attendance saved successfully');
        }
        
        // Save student attendance to localStorage
        function saveStudentAttendance() {
            localStorage.setItem('studentAttendance', JSON.stringify(studentAttendance));
            
            // Add activity
            const selectedClass = document.getElementById('attendance-class').value;
            activities.unshift({
                date: formatDateForStorage(currentDate),
                activity: "Student Attendance",
                details: `Student attendance saved for Class ${selectedClass} on ${formatDate(currentDate)}`
            });
            localStorage.setItem('activities', JSON.stringify(activities));
            
            updateDashboardStats();
            showNotification('Student attendance saved successfully');
        }
        
        // Handle student registration form
        document.getElementById('studentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const studentId = students.length > 0 ? Math.max(...students.map(s => s.id)) + 1 : 1;
            
            const newStudent = {
                id: studentId,
                name: document.getElementById('studentName').value,
                fatherName: document.getElementById('fatherName').value,
                dob: document.getElementById('dob').value,
                class: document.getElementById('studentClass').value,
                grNumber: document.getElementById('grNumber').value,
                bform: document.getElementById('bform').value,
                contact: document.getElementById('contact').value,
                address: document.getElementById('address').value,
                previousSchool: document.getElementById('previousSchool').value,
                photo: document.getElementById('student-photo-img').src || null,
                registrationDate: new Date().toISOString().split('T')[0]
            };
            
            students.push(newStudent);
            localStorage.setItem('students', JSON.stringify(students));
            
            // Add activity
            activities.unshift({
                date: newStudent.registrationDate,
                activity: "Student Registration",
                details: `New student ${newStudent.name} (GR: ${newStudent.grNumber}) registered in ${newStudent.class}`
            });
            localStorage.setItem('activities', JSON.stringify(activities));
            
            // Reset form
            this.reset();
            document.getElementById('student-photo-img').style.display = 'none';
            document.querySelector('#student-photo-preview .photo-placeholder').style.display = 'block';
            
            // Set default DOB
            const defaultDOB = new Date();
            defaultDOB.setFullYear(defaultDOB.getFullYear() - 10);
            document.getElementById('dob').valueAsDate = defaultDOB;
            
            // Update UI
            loadStudentsList();
            updateDashboardStats();
            showNotification(`Student ${newStudent.name} registered successfully`);
        });
        
        // Add teacher
        document.getElementById('add-teacher-btn').addEventListener('click', function() {
            const teacherName = document.getElementById('teacher-name').value.trim();
            const teacherDesignation = document.getElementById('teacher-designation').value.trim();
            const teacherPhoto = document.getElementById('teacher-photo-img').src || null;
            
            if (!teacherName) {
                showNotification('Please enter teacher name', 'error');
                return;
            }
            
            const teacherId = teachers.length > 0 ? Math.max(...teachers.map(t => t.id)) + 1 : 1;
            
            const newTeacher = {
                id: teacherId,
                name: teacherName,
                designation: teacherDesignation || "Teacher",
                photo: teacherPhoto
            };
            
            teachers.push(newTeacher);
            localStorage.setItem('teachers', JSON.stringify(teachers));
            
            // Add activity
            activities.unshift({
                date: new Date().toISOString().split('T')[0],
                activity: "Teacher Added",
                details: `New teacher ${teacherName} added as ${newTeacher.designation}`
            });
            localStorage.setItem('activities', JSON.stringify(activities));
            
            // Clear inputs
            document.getElementById('teacher-name').value = '';
            document.getElementById('teacher-designation').value = '';
            document.getElementById('teacher-photo-img').style.display = 'none';
            document.querySelector('#teacher-photo-preview .photo-placeholder').style.display = 'block';
            
            // Update UI
            loadTeachersList();
            updateDashboardStats();
            showNotification(`Teacher ${teacherName} added successfully`);
        });
        
        // Set Head Master
        document.getElementById('set-hm-btn').addEventListener('click', function() {
            const hmName = document.getElementById('head-master-input').value.trim();
            
            if (!hmName) {
                showNotification('Please enter Head Master name', 'error');
                return;
            }
            
            headMaster = hmName;
            localStorage.setItem('headMaster', headMaster);
            
            // Add activity
            activities.unshift({
                date: new Date().toISOString().split('T')[0],
                activity: "Head Master Set",
                details: `${hmName} set as Head Master`
            });
            localStorage.setItem('activities', JSON.stringify(activities));
            
            // Update UI
            updateHeadMasterDisplay();
            showNotification(`Head Master set to ${hmName}`);
        });
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Apply saved theme
            applyTheme(currentTheme);
            
            // Set current dates
            document.getElementById('current-date').textContent = formatDate(currentDate);
            document.getElementById('current-date-student').textContent = formatDate(currentDate);
            
            // Set current month in student attendance
            const currentMonth = currentDate.getMonth();
            document.getElementById('attendance-month').value = currentMonth;
            
            // Set current date in DOB field (for reasonable default)
            const defaultDOB = new Date();
            defaultDOB.setFullYear(defaultDOB.getFullYear() - 10);
            document.getElementById('dob').valueAsDate = defaultDOB;
            
            // Show dashboard by default
            showSection('dashboard');
            updateDashboardStats();
            updateHeadMasterDisplay();
            
            // Navigation event listeners
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSection(this.dataset.target);
                });
            });
            
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSection(this.dataset.target);
                });
            });
            
            // Theme selector
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const theme = this.dataset.theme;
                    applyTheme(theme);
                });
            });
            
            // Date navigation for teacher attendance
            document.getElementById('prev-day').addEventListener('click', function() {
                currentDate.setDate(currentDate.getDate() - 1);
                loadTeacherAttendance();
                updateDashboardStats();
            });
            
            document.getElementById('next-day').addEventListener('click', function() {
                currentDate.setDate(currentDate.getDate() + 1);
                loadTeacherAttendance();
                updateDashboardStats();
            });
            
            // Date navigation for student attendance
            document.getElementById('prev-day-student').addEventListener('click', function() {
                currentDate.setDate(currentDate.getDate() - 1);
                loadStudentAttendance();
                updateDashboardStats();
            });
            
            document.getElementById('next-day-student').addEventListener('click', function() {
                currentDate.setDate(currentDate.getDate() + 1);
                loadStudentAttendance();
                updateDashboardStats();
            });
            
            // Mark all present/absent/leave for teachers
            document.getElementById('mark-all-present').addEventListener('click', function() {
                teachers.forEach(teacher => {
                    markTeacherAttendance(teacher.id, 'present');
                });
                showNotification('All teachers marked as present');
            });
            
            document.getElementById('mark-all-absent').addEventListener('click', function() {
                teachers.forEach(teacher => {
                    markTeacherAttendance(teacher.id, 'absent');
                });
                showNotification('All teachers marked as absent');
            });
            
            document.getElementById('mark-all-leave').addEventListener('click', function() {
                teachers.forEach(teacher => {
                    markTeacherAttendance(teacher.id, 'leave');
                });
                showNotification('All teachers marked as on leave');
            });
            
            // Mark all present/absent/leave for students
            document.getElementById('mark-all-present-student').addEventListener('click', function() {
                const selectedClass = document.getElementById('attendance-class').value;
                const classStudents = students.filter(student => student.class === selectedClass);
                
                classStudents.forEach(student => {
                    markStudentAttendance(student.id, 'present');
                });
                showNotification(`All students in ${selectedClass} marked as present`);
            });
            
            document.getElementById('mark-all-absent-student').addEventListener('click', function() {
                const selectedClass = document.getElementById('attendance-class').value;
                const classStudents = students.filter(student => student.class === selectedClass);
                
                classStudents.forEach(student => {
                    markStudentAttendance(student.id, 'absent');
                });
                showNotification(`All students in ${selectedClass} marked as absent`);
            });
            
            document.getElementById('mark-all-leave-student').addEventListener('click', function() {
                const selectedClass = document.getElementById('attendance-class').value;
                const classStudents = students.filter(student => student.class === selectedClass);
                
                classStudents.forEach(student => {
                    markStudentAttendance(student.id, 'leave');
                });
                showNotification(`All students in ${selectedClass} marked as on leave`);
            });
            
            // Save attendance buttons
            document.getElementById('save-teacher-attendance').addEventListener('click', saveTeacherAttendance);
            document.getElementById('save-student-attendance').addEventListener('click', saveStudentAttendance);
            
            // Class change event for student attendance
            document.getElementById('attendance-class').addEventListener('change', loadStudentAttendance);
            
            // Generate statistics
            document.getElementById('generate-stats').addEventListener('click', generateDetailedStats);
            
            // Photo upload for student
            document.getElementById('student-upload-btn').addEventListener('click', function() {
                document.getElementById('student-photo-input').click();
            });
            
            document.getElementById('student-photo-input').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        document.getElementById('student-photo-img').src = event.target.result;
                        document.getElementById('student-photo-img').style.display = 'block';
                        document.querySelector('#student-photo-preview .photo-placeholder').style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Photo upload for teacher
            document.getElementById('teacher-upload-btn').addEventListener('click', function() {
                document.getElementById('teacher-photo-input').click();
            });
            
            document.getElementById('teacher-photo-input').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        document.getElementById('teacher-photo-img').src = event.target.result;
                        document.getElementById('teacher-photo-img').style.display = 'block';
                        document.querySelector('#teacher-photo-preview .photo-placeholder').style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Initialize local storage if empty
            if (!localStorage.getItem('teachers')) {
                localStorage.setItem('teachers', JSON.stringify(teachers));
            }
            
            if (!localStorage.getItem('activities')) {
                localStorage.setItem('activities', JSON.stringify(activities));
            }
            
            if (!localStorage.getItem('theme')) {
                localStorage.setItem('theme', 'light');
            }
        });
    </script>
</body>
</html>